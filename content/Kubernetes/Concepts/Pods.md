---
title: "Pods"
menuTitle: "Pods"
date:  2020-02-03T14:03:50+09:00
weight: 10
draft: false
tags: ["kubernetes", "pod"]
pre: "<i class='fas fa-minus'></i>&nbsp;"
---

Pod

Pod는 Kubernetes에서 가장 작은 배포 오브젝트. 최소 관리 단위.
클러스터에서 실행중인 프로세스를 의미
어플리케이션 콘테이너, 스토리지 리소스, 유일한 network ip, 컨테이너가 어떻게 실행할지를 캡슐화

각각의 파드는 주어진 어플리케이션에서 단일 인스턴스를 수행한다.
-> 어플리케이션을 수직확장하고 싶다면 각 인스턴스에 대해 여러 파드를 생성하면 된다.

파드는 서비스에서 서로 연관성이 높은 프로세스를 지원하기 위해 디자인되었다.
컨테이너는 리소스와 의존성들을 공유하고, 서로 통신하며, 언제/어떻게 종료하는지에 대해 조정한다.

파드 내에 여러 컨테이너를 두는 것은 컨테이너가 정말 강하게 결합될 때 이다.

init container로 app container가 시작하기 전의 동작을 할 수 있다.
파드 내의 컨테이너는 Networking과 Storage를 공유한다.

Networking
각 파드 단위로 네트워크 IP 주소를 할당받는다. 그 내부의 컨테이너는 localhost로 통신하게 되고 외부와의 통신을 위해선 공유중인 네트워크 리소스를 어떻게 분배할 지 합의 및 조정해야한다. (port)

Storage
파드는 공유하는 저장공간을 volumes로 지정한다. 하나의 컨테이너만 재시동되는 경우에도 데이터를 보존할 수 있다.

파드는 하나만 생성하지 말 것.

파드의 재시작과 컨테이너의 재시작을 헷갈려하면 안된다. 파드 자체만으로는 동작하지 않고, 오히려 컨테이너가 동작하는 환경이라고 보면 된다. 삭제 전까지는 유지 되는.

파드는 컨테이너 전에 VM에서 하나의 VM에 실행하는 것들처럼 하나의 논리적 호스트에서 컨테이너들을 실행하는 개념이다.

파드 내의 컨테이너들은 IP주소와 port space를 공유한다.
그리고 localhost로 통신한다. + SystemV semaphore, POSIX shared memory로 통신 가능
다른 파드에 있는 컨테이너와는 IP 주소로 통신

Volumes도 공유 가능

파드는 컨테이너처럼 임시적인 자원이기 때문에 삭제시 reschedule이 아닌 새로운 동일한 spec의 파드를 생성한다. (새로운 UID로)

volume도 파드가 삭제되면 삭제된다.

각각의 파드는 보통 하나의 어플리케이션의 여러 인스턴스를 담당하지 않는다.

왜 하나의 컨테이너에서 여러 프로그램을 돌리지 않는가?

* 투명성
* 쓰기 쉬움
* 소프트웨어 의존성 제거
* 효율성

`privileged` 플래그로 LINUX단의 조작을 할 수 있다.

## Pod Lifecycle

Pod의 `status` 필드는 PodStatus의 `phase` 필드이다.

파드의 phase는 간단하게 Pod가 위치한 lifecycle의 상위 개념에서의 요약이다.

`phase` 의 value들 

* `Pending` : 파드가 kubernetes 시스템에 의해 받아들여졌지만 
* 